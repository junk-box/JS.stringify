<html>
	<head>
		<meta charset="UTF-8">
		<title>JS.stringify</title>
	</head>
	<body>
		<p style="margin-bottom: 5px;">ブックマークのURLを以下のテキストに置き換えます。</p>
		<textarea rows="2" spellcheck="false" wrap="off"  style="width: 50%;">javascript:(function(){var a=document.createElement("div");a.id="JS.stringify_control";a.style.cssText="position: fixed !important;top: 0px !important;right: 3px !important;z-index: 2147483647 !important;padding: 3px !important;padding-top: 1px !important;background-color: #dfdfdf !important;border: solid 1px #aaaaab !important;border-top-width: 0px !important;border-top-left-radius: 0px !important;border-top-right-radius: 0px !important;border-bottom-left-radius: 3px !important;border-bottom-right-radius: 3px !important;";a.innerHTML='<input type=\'text\' style=\'display: inline !important;outline: none !important;box-shadow: 0px 0px !important;border: solid 1px #aaaaab !important;border-top-color: #969696 !important;border-top-left-radius: 3px !important;border-bottom-left-radius: 3px !important;border-top-right-radius: 0px !important;border-bottom-right-radius: 0px !important;border-right-width: 0px !important;line-height: 1 !important;width: 218px !important;height: 100% !important;min-height: 100% !important;max-height: 100% !important;margin: 0px !important;vertical-align: baseline !important;padding: 4px 6px 3px !important;background-color: #ffffff !important;color: #000 !important;font: 12px/1 Arial !important;\' onkeyup=\'(function(val) {var e = window.event || event;if (e.keyCode != 13) return;var dv = document.getElementById("JS.stringify_view");if (dv) document.body.removeChild(dv);var select = document.createElement("a");select.style.cssText = "color: #609 !important;background-color: #fffbf0 !important;font: normal 12px/1 sans-serif !important;cursor: pointer !important;";select.innerHTML = "select";select.onclick = function() {var selection = document.getSelection();var range = selection.getRangeAt(0);range.selectNode(document.getElementById("JS.stringify_view").children[1]);selection.removeAllRanges();selection.addRange(range);};var close = document.createElement("a");close.style.cssText = "margin-left: 8px !important;color: #609 !important;background-color: #fffbf0 !important;font: normal 12px/1 sans-serif !important;cursor: pointer !important;";close.innerHTML = "close";close.onclick = function() {document.body.removeChild(document.getElementById("JS.stringify_view"));};var divA = document.createElement("div");divA.style.cssText = "margin-top: 5px !important;text-align: right !important;";divA.appendChild(select);divA.appendChild(close);var count = 0;var _stringify = function(obj, depth, indent, fn) {count++;var ot = typeof(obj);if (ot != "object" && ot != "function")return ot == "string" ? "\\"" + obj + "\\"" : obj;var sp = function(len) {var s = "";var nbsp = String.fromCharCode(160);for (var i = 0; i < len * 4; i++) s += nbsp;return s;};if (depth == indent) return "{...}";var t, v, json = [], arr = (obj && obj.constructor == Array);for (var n in obj) {v = obj[n];t = typeof(v);if (Object.prototype.hasOwnProperty.call(obj, n)) {if (t == "function") {if (fn) continue;var f = String(v);v = f.substring(0, f.indexOf(")") + 1) + " {...}";}else if (t == "string") v = "\\"" + v.replace(/\\"/g, "\\\\\\"") + "\\"";else if (t == "object" &&  v != null) v = arguments.callee(v, depth, indent + 1, fn);else v = String(v);json.push((arr ? "" : "\\"" + n + "\\": ") + v);if (count > 1000) throw new Error("too big object.");}}return (arr ? "[" : "{") + "</span></div>\\n<div><span>" + sp(indent + 1) + json.join(",</span></div>\\n<div><span>" + sp(indent + 1)) + "</span></div>\\n<div><span>" + sp(indent) + (arr ? "]" : "}");};var stringify = function(txt) {try {var depth = document.getElementById("JS.stringify_control_depth").innerHTML;var fn = document.getElementById("JS.stringify_control_fn").style.color;return _stringify(eval(txt), isNaN(depth) ? 1000 : Number(depth), 0, fn == "rgb(82, 82, 82)");} catch (ex) {return ex.message;}};var divRow = document.createElement("div");divRow.style.cssText = "margin-top: 10px !important;";divRow.innerHTML = "<div><span>" + stringify(val) + "</span></div>";var divView = document.createElement("div");divView.id = "JS.stringify_view";divView.style.cssText = "position: fixed !important;top: 10% !important;left: 10% !important;max-width: 80% !important;max-height: 80% !important;z-index: 2147483647 !important;text-align: left !important;border: solid 1px #666 !important;background-color: #fffbf0 !important;padding: 3px 8px 15px 15px !important;";divView.appendChild(divA);divView.appendChild(divRow);document.body.appendChild(divView);var rmPx = function(len) {return Number(len.substring(0, len.length - 2));};divRow.style.cssText = "margin-top: 10px !important;overflow: auto !important;max-width: " + (Math.floor(window.innerWidth * 0.8) - rmPx(divView.style.paddingLeft) - rmPx(divView.style.paddingRight)) + "px !important;max-height: " + (Math.floor(window.innerHeight * 0.8) - rmPx(divView.style.paddingTop) - divA.clientHeight - rmPx(divView.style.paddingBottom) - 20) + "px !important;padding-right: 40px !important;padding-bottom: 5px !important;color: #000 !important;background-color: #fffbf0 !important;text-align: left !important;font: normal 12px/1 monospace !important;white-space: nowrap !important;";})(this.value)\'><a id=\'JS.stringify_control_depth\' title=\'depth\' style=\'position: relative !important;top: 2px !important;font: bold 18px/1.0 Comic Sans MS !important;border: 1px solid #aaaaab !important;border-right-width: 0px !important;border-top-color: #969696 !important;border-top-left-radius: 0px !important;border-bottom-left-radius: 0px !important;border-top-right-radius: 0px !important;border-bottom-right-radius: 0px !important;padding: 3px 5px 1px 5px !important;text-decoration: none !important;background-color: #eeeeef !important;color: rgb(82, 82, 82) !important;text-shadow: rgb(255, 255, 255) 1px 1px 0px !important;outline: none !important;cursor: pointer !important;display: inline-block !important;\' onclick=\'(function() {var depth = event ? event.target : window.event.srcElement;if (depth.innerHTML == "1") {depth.innerHTML = "3";} else if (depth.innerHTML == "3") {depth.innerHTML = "5";} else if (depth.innerHTML == "5") {depth.innerHTML = "&infin;";depth.style.cssText = "position: relative !important;top: 2px !important;font: bold 18px/1.0 Comic Sans MS !important;border: 1px solid #aaaaab !important;border-right-width: 0px !important;border-top-color: #969696 !important;border-top-left-radius: 0px !important;border-bottom-left-radius: 0px !important;border-top-right-radius: 0px !important;border-bottom-right-radius: 0px !important;padding: 3px 5px 1px 5px !important;text-decoration: none !important;background-color: #eeeeef !important;color: rgb(82, 82, 82) !important;text-shadow: rgb(255, 255, 255) 1px 1px 0px !important;outline: none !important;cursor: pointer !important;display: inline-block !important;";} else {depth.innerHTML = "1";depth.style.cssText = "position: relative !important;top: 1px !important;font: bold 14px/1.0 Comic Sans MS !important;border: 1px solid #aaaaab !important;border-right-width: 0px !important;border-top-color: #969696 !important;border-top-left-radius: 0px !important;border-bottom-left-radius: 0px !important;border-top-right-radius: 0px !important;border-bottom-right-radius: 0px !important;padding: 5px 8px 3px 8px !important;text-decoration: none !important;background-color: #eeeeef !important;color: rgb(82, 82, 82) !important;text-shadow: rgb(255, 255, 255) 1px 1px 0px !important;outline: none !important;cursor: pointer !important;display: inline-block !important;";}})()\'>&infin;</a><a id=\'JS.stringify_control_fn\' title=\'include function\' style=\'position: relative !important;top: 1px !important;font: bold 15px/1.0 Arial !important;border: 1px solid #aaaaab !important;border-right-width: 0px !important;border-top-color: #969696 !important;border-top-left-radius: 0px !important;border-bottom-left-radius: 0px !important;border-top-right-radius: 0px !important;border-bottom-right-radius: 0px !important;padding: 5px 5px 2px 6px !important;text-decoration: none !important;background-color: #eeeeef !important;color: rgb(82, 82, 82) !important;text-shadow: rgb(255, 255, 255) 1px 1px 0px !important;outline: none !important;cursor: pointer !important;display: inline-block !important;\' onclick=\'(function() {var fn = event ? event.target : window.event.srcElement;var status = fn.style.color == "rgb(82, 82, 82)";fn.title = status ? "exclude function" : "include function";fn.style.cssText = "position: relative !important;top: 1px !important;font: bold 15px/1.0 Arial !important;border: 1px solid #aaaaab !important;border-right-width: 0px !important;border-top-color: #969696 !important;border-top-left-radius: 0px !important;border-bottom-left-radius: 0px !important;border-top-right-radius: 0px !important;border-bottom-right-radius: 0px !important;padding: 5px 5px 2px 6px !important;text-decoration: none !important;background-color: #eeeeef !important;color: " + (status ? "rgb(66, 129, 235)" : "rgb(82, 82, 82)") + " !important;text-shadow: " + (status ? "rgb(129, 169, 237) 0px 0px 1px" : "rgb(255, 255, 255) 1px 1px 0px") + " !important;outline: none !important;cursor: pointer !important;display: inline-block !important;";})()\'>fn</a><a title=\'close\'style=\'position: relative !important;top: 2px !important;font: bold 17px/1.0 Impact !important;border: 1px solid #aaaaab !important;border-top-color: #969696 !important;border-top-left-radius: 0px !important;border-bottom-left-radius: 0px !important;border-top-right-radius: 3px !important;border-bottom-right-radius: 3px !important;padding: 3px 8px 2px 7px !important;text-decoration: none !important;background-color: #eeeeef !important;color: #525252 !important;display: inline-block !important;text-shadow: 1px 1px 0px #ffffff !important;outline: none !important;cursor: pointer !important;\' onclick=\'(function() {var view = document.getElementById("JS.stringify_view");if (view) document.body.removeChild(view);document.body.removeChild(document.getElementById("JS.stringify_control"));})()\'>&times;</a>';document.body.appendChild(a)})();</textarea>
		<p style="margin-bottom: 5px;">IE用 ※ オフライン環境では動作しません。</p>
		<textarea rows="2" spellcheck="false" wrap="off"  style="width: 50%;">javascript:(function(){var a=document.createElement("script");a.setAttribute("language","javascript");a.setAttribute("charset","UTF-8");a.setAttribute("src","http://junk-box.appspot.com/bookmarklet/JS.stringify/JS.stringify.min.js");document.body.appendChild(a)})();</textarea>
	</body>
</html>
